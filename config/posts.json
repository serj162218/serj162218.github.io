{
  "posts": [
    {
      "content": "insert mode\r\ni\r\nnormal\r\nesc\r\n左下上右\r\nh j k l\r\n移動到下個單字\r\nw\r\n移動到此字的首\r\nb\r\n移動到此字的尾\r\ne\r\n\r\n數字+指令 = 重複指令三次\r\n3h -> 往左三下 3w -> 跳三次下個單字\r\n\r\ninsert mode也能配數字\r\n3igo esc -> gogogo\r\n30i- esc -> 30個-\r\n\r\n找下(上)個字，可以配數字 (單行搜尋)\r\nf F\r\nfo -> 找下個o\r\nFo -> 找上個o\r\n3fq -> 往下找第三個q\r\n\r\n找( { [ 配對的括弧\r\n%\r\n\r\n到句子首尾\r\n0 $\r\n\r\n跳到這個字的下(上)個地方 例如在the用*就會到下個the\r\n* #\r\n\r\n到檔案一開始(最後面)\r\ngg G\r\n\r\n到特定的行數 行數+G\r\n2G -> 第二行\r\n\r\n搜尋字 (往下 往上)\r\n/ n N\r\n例如 / text 搜尋text 然後往下(n)\r\n\r\ninsert new line(往下 往上) 會變insert mode\r\no O\r\n\r\ndelete word\r\nx X\r\n\r\nreplace one word\r\nr + 要的字\r\n\r\ndelete command\r\nd\r\ndw 刪掉下個單字\r\np可以貼上刪掉的字\r\nd2e 可以配數字刪掉兩個字\r\n\r\n重複上個指令\r\n.\r\nd2w後用 . 可以一直執行 d2w\r\n\r\nvisual mode (選取模式)\r\nv\r\nex: v + e + l + d 刪掉目前這個字\r\n\r\n:w (save) :q (quit) :q! (quit without saving)\r\n\r\nu undo ctrl + R redo",
      "data": {
        "title": "vim 指南",
        "date": "2022-11-01 12:07:57",
        "tags": [],
        "published": true,
        "hideInList": false,
        "feature": null,
        "isTop": false
      },
      "isEmpty": false,
      "excerpt": "",
      "abstract": "",
      "fileName": "vim-zhi-nan"
    },
    {
      "content": "<h1>遞迴版本</h1>\r\n從0,0開始往四個方向走，用一個array去存現在走哪個方向\r\n如果碰到終點(maze.length-1 && maze.length -1)就代表成功了\r\n如果有一條遞迴的路成功了，就一直把這成功的訊息傳下去\r\n如果這條路失敗了，就把array剛剛存的「現在走的方向」移除掉\r\n最後輸出array就是答案了\r\n在走的時候，下一步不能是原點，也不能超出範圍\r\n\r\n<h1>Recursion</h1>\r\nStart with (0,0) (you can start with any point)\r\nThere must be a way to exit.\r\nUse recursive to try any four direction, then use an array to save what directions it goes.\r\nIf the way is return true, keep returning true until the start of the recursion.\r\nIf the way is failed. pop out the latest array you push in.\r\nThe next step can't be neither start point nor out of range.\r\n\r\n```javascript=\r\nlet findRoad = function (maze) {\r\n    let road = [];\r\n    helper(maze, road, 0, 0);\r\n    return road;\r\n}\r\n\r\nlet helper = function (maze, road, i, j) {\r\n    if (i == maze.length - 1 && j == maze[i].length - 1) return true;\r\n\r\n    /**\r\n     * i+1 S\r\n     * i-1 N\r\n     * j+1 E\r\n     *j-1 W\r\n     */\r\n\r\n    if (j < maze[i].length - 1 && maze[i][j + 1] !== 0) {\r\n        maze[i][j + 1] = 0;\r\n        road.push(\"E\");\r\n        if (helper(maze, road, i, j + 1) == true) return true;\r\n    }\r\n    if (i < maze.length - 1 && maze[i + 1][j] !== 0) {\r\n        maze[i + 1][j] = 0;\r\n        road.push(\"S\");\r\n        if (helper(maze, road, i + 1, j) == true) return true;\r\n    }\r\n    if (i > 0 && maze[i - 1][j] !== 0 && !(i == 1 && j == 0)) {\r\n        maze[i - 1][j] = 0;\r\n        road.push(\"N\");\r\n        if (helper(maze, road, i - 1, j) == true) return true;\r\n    }\r\n    if (j > 0 && maze[i][j - 1] !== 0 && !(i == 0 && j == 1)) {\r\n        maze[i][j - 1] = 0;\r\n        road.push(\"W\");\r\n        if (helper(maze, road, i, j - 1) == true) return true;\r\n    }\r\n    road.pop();\r\n}\r\n\r\nlet maze = [\r\n    [1, 1, 1, 1, 1],\r\n    [0, 1, 0, 0, 1],\r\n    [0, 1, 0, 0, 1],\r\n    [0, 0, 1, 0, 1],\r\n    [0, 0, 1, 1, 1],\r\n]\r\nlet maze2 = [\r\n    [1, 1, 1, 0, 1],\r\n    [0, 1, 0, 0, 1],\r\n    [0, 1, 1, 0, 1],\r\n    [0, 0, 1, 0, 1],\r\n    [0, 0, 1, 1, 1],\r\n];\r\nlet maze3 = [\r\n    [1, 1, 1, 1, 1],\r\n    [1, 0, 0, 0, 0],\r\n    [1, 0, 1, 1, 1],\r\n    [1, 0, 1, 0, 1],\r\n    [1, 1, 1, 0, 1],\r\n];\r\nlet maze4 = [\r\n    [1, 0, 0, 0, 1],\r\n    [1, 1, 1, 0, 0],\r\n    [1, 0, 1, 0, 1],\r\n    [1, 0, 1, 0, 1],\r\n    [1, 0, 1, 1, 1],\r\n];\r\nconsole.log(findRoad(maze));\r\nconsole.log(findRoad(maze2));\r\nconsole.log(findRoad(maze3));\r\nconsole.log(findRoad(maze4));\r\n```\r\n\r\n<h1>迴圈</h1>\r\n使用array紀錄走過的路，然後用String紀錄方向\r\n起點先設為0(代表走過了)\r\n判斷四個方向中不是0的路，走過去時用array紀錄「走之前的座標」，並用String紀錄剛剛的方向，然後把「現在要走的座標」設為0代表走過了。\r\n當走到終點時把迴圈break掉\r\n如果走到死路了，因為有用array紀錄剛剛的路，所以可以回到上一個點，String也要把剛剛最後紀錄的方向刪掉。\r\n最後印出String就是答案了\r\n\r\n<h1>Iteration </h1>\r\nUse an array to record the road it just went, then use a string to record the directions.\r\nThe start point is set to 0.\r\nGoing four diections which is not 0, use array to record the position before go, then use string to record the direction. Remeber to set the point to 0, means it has passed this way.\r\nTo break the loop if it arrive the end.\r\nIf there's no way to go, use the latest item in array, then delete the latest char in String.\r\n\r\nPrint out the String, which is the answer.\r\n\r\n```javascript=\r\nlet findRoad = function (maze) {\r\n    return helper(maze, 0, 0);\r\n}\r\n\r\nlet helper = function (maze, i, j) {\r\n    let road = [];\r\n    let roadStr = \"\";\r\n    maze[0][0] = 0;\r\n    while (true) {\r\n        if(i === maze.length - 1 && j  === maze[i].length - 1) break;\r\n        if (i < maze.length - 1 && maze[i + 1][j] !== 0) {\r\n            road.push([i, j]);\r\n            roadStr += \"S\";\r\n            maze[i + 1][j] = 0;\r\n            i++;\r\n        } else if (i > 0 && maze[i - 1][j] !== 0) {\r\n            road.push([i, j]);\r\n            roadStr += \"N\";\r\n            maze[i - 1][j] = 0;\r\n            i--;\r\n        } else if (j < maze[i].length - 1 && maze[i][j + 1] !== 0) {\r\n            road.push([i, j]);\r\n            roadStr += \"E\";\r\n            maze[i][j + 1] = 0;\r\n            j++;\r\n        } else if (j > 0 && maze[i][j - 1] !== 0) {\r\n            road.push([i, j]);\r\n            roadStr += \"W\";\r\n            maze[i][j - 1] = 0;\r\n            j--;\r\n        } else {\r\n            let tmp = road.pop();\r\n            i = tmp[0];\r\n            j = tmp[1];\r\n            roadStr = roadStr.substring(0, roadStr.length - 1);\r\n        }\r\n    }\r\n    return roadStr;\r\n}\r\n\r\nlet maze = [\r\n    [1, 1, 1, 1, 1],\r\n    [0, 1, 0, 0, 1],\r\n    [0, 1, 0, 0, 1],\r\n    [0, 0, 1, 0, 1],\r\n    [0, 0, 1, 1, 1],\r\n]\r\nlet maze2 = [\r\n    [1, 1, 1, 0, 1],\r\n    [0, 1, 0, 0, 1],\r\n    [0, 1, 1, 0, 1],\r\n    [0, 0, 1, 0, 1],\r\n    [0, 0, 1, 1, 1],\r\n];\r\nlet maze3 = [\r\n    [1, 1, 1, 1, 1],\r\n    [1, 0, 0, 0, 0],\r\n    [1, 0, 1, 1, 1],\r\n    [1, 0, 1, 0, 1],\r\n    [1, 1, 1, 0, 1],\r\n];\r\nlet maze4 = [\r\n    [1, 0, 0, 0, 1],\r\n    [1, 1, 1, 0, 0],\r\n    [1, 0, 1, 0, 1],\r\n    [1, 0, 1, 0, 1],\r\n    [1, 0, 1, 1, 1],\r\n];\r\nlet maze5 = [\r\n    [1, 0, 1, 1, 1],\r\n    [1, 1, 1, 0, 1],\r\n    [0, 0, 1, 0, 1],\r\n    [0, 1, 1, 0, 1],\r\n    [1, 1, 0, 0, 1],\r\n];\r\nconsole.log(findRoad(maze));\r\nconsole.log(findRoad(maze2));\r\nconsole.log(findRoad(maze3));\r\nconsole.log(findRoad(maze4));\r\nconsole.log(findRoad(maze5));\r\n```",
      "data": {
        "title": "Maze find a way out with Javascript ( Recursion & Iteration )",
        "date": "2022-10-14 15:38:17",
        "tags": [],
        "published": true,
        "hideInList": false,
        "feature": null,
        "isTop": false
      },
      "isEmpty": false,
      "excerpt": "",
      "abstract": "",
      "fileName": "maze-find-a-way-out-with-javascript-recursion"
    },
    {
      "content": "the algorithm is reference by https://www.youtube.com/watch?v=WLvU5EQVZqY\r\n```javascript=\r\nfunction TreeNode(val, left, right) {\r\n    this.val = (val === undefined ? 0 : val)\r\n    this.left = (left === undefined ? null : left)\r\n    this.right = (right === undefined ? null : right)\r\n}\r\n\r\nvar order = function (root) {\r\n    if (!root) return [];\r\n    let h = root;\r\n    let ans = [];\r\n    let stack = [];\r\n    let map = new Map();\r\n    do {\r\n        if(h && map.get(h)){\r\n            map.set(h, map.get(h)+1);\r\n        }else if(h){\r\n            map.set(h, 1);\r\n        }\r\n\r\n        if(map.get(h) === 1){ // 1 = preorder, 2 = inorder, 3 = postorder\r\n            ans.push(h);\r\n        }\r\n\r\n        if(!h){\r\n            h = stack.pop();\r\n        }\r\n        else if (h.left !== -1) {\r\n            stack.push(h);\r\n            let b = h.left;\r\n            h.left = -1;\r\n            h = b;\r\n        } else if (h.right !== -1) {\r\n            stack.push(h);\r\n            let b = h.right;\r\n            h.right = -1;\r\n            h = b;\r\n        } else if (h.left === -1 && h.right === -1){\r\n            h = stack.pop();\r\n        }\r\n    } while (stack.length || h === root);\r\n    ans = ans.map(v => v.val);\r\n    return ans;\r\n};\r\n```",
      "data": {
        "title": "Three types of Order in Binary Tree with Javascript ( Iteration )",
        "date": "2022-10-13 17:57:24",
        "tags": [],
        "published": true,
        "hideInList": false,
        "feature": null,
        "isTop": false
      },
      "isEmpty": false,
      "excerpt": "",
      "abstract": "",
      "fileName": "three-types-of-order-in-binary-tree-with-javascript"
    },
    {
      "content": "Preorder, the first time pointer meet the node, print it out.\r\n\r\n```javascript=\r\n//structor\r\nfunction TreeNode(val, left, right) {\r\n     this.val = (val===undefined ? 0 : val)\r\n     this.left = (left===undefined ? null : left)\r\n     this.right = (right===undefined ? null : right)\r\n }\r\n\r\nvar preorderTraversal = function(root) {\r\n    if(!root) return [];\r\n    let ans = [];\r\n    let h = root;\r\n    \r\n    let stack = []; //to remember the previous node\r\n    while(h){\r\n        if(!ans.includes(h)){\r\n            ans.push(h); // not h.val because h.val may be duplicated.\r\n        }\r\n        if(h.left !== null && !ans.includes(h.left)){\r\n            stack.push(h);\r\n            h = h.left;\r\n        }else if(h.right !== null && !ans.includes(h.right)){\r\n            stack.push(h);\r\n            h = h.right;\r\n        }else{\r\n            h = stack.pop();\r\n        }\r\n    }\r\n\r\n    //switch h to h.val\r\n    ans = ans.map(v => v.val);\r\n    \r\n    return ans;\r\n};\r\n```",
      "data": {
        "title": "Binary Tree Preorder Traversal with Javascript ( Iteration )",
        "date": "2022-10-12 17:20:24",
        "tags": [],
        "published": true,
        "hideInList": false,
        "feature": null,
        "isTop": false
      },
      "isEmpty": false,
      "excerpt": "",
      "abstract": "",
      "fileName": "binary-tree-preorder-traversal-with-javascript-not-recursive"
    },
    {
      "content": "- Every node can only have at most 2 children.\r\n\r\nThis tree is imcompleted because it doesn't have delete function and auto-balance function.\r\n```javascript=\r\nclass Tree {\r\n    constructor(val) {\r\n        this.root = new Heap(val);\r\n    }\r\n    add(val, heap = this.root) {\r\n        if (val >= heap.val) {\r\n            if (heap.right !== null) {\r\n                this.add(val, heap.right);\r\n            } else {\r\n                heap.right = new Heap(val);\r\n            }\r\n        } else {\r\n            if (heap.left !== null) {\r\n                this.add(val, heap.left);\r\n            } else {\r\n                heap.left = new Heap(val);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nclass Heap {\r\n    constructor(val, left, right) {\r\n        this.val = val ? val : null;\r\n        this.left = left ? left : null;\r\n        this.right = right ? right : null;\r\n    }\r\n}\r\n\r\nlet tree = new Tree(5);\r\ntree.add(3);\r\ntree.add(7);\r\ntree.add(8);\r\ntree.add(4);\r\nconsole.log(tree);\r\n```",
      "data": {
        "title": "Javascript instance Binary Tree with simple code",
        "date": "2022-10-11 16:07:31",
        "tags": [],
        "published": false,
        "hideInList": false,
        "feature": null,
        "isTop": false
      },
      "isEmpty": false,
      "excerpt": "",
      "abstract": "",
      "fileName": "javascript-instance-tree-with-simple-code"
    },
    {
      "content": "```javascript=\r\nclass LinkedList {\r\n\r\n    constructor() {\r\n        this.node = new ListNode(-1);\r\n        this.length = 0;\r\n    }\r\n\r\n    /**\r\n     * Append a new ListNode to this LinkedList\r\n     */\r\n    append(val) {\r\n        let head = this.node;\r\n        while (head.next) {\r\n            head = head.next;\r\n        }\r\n        head.next = new ListNode(val);\r\n        this.length++;\r\n    }\r\n\r\n    /**\r\n     * delete the first item which's value == val\r\n     */\r\n    delete(val) {\r\n        let head = this.node.next;\r\n        let prev = this.node;\r\n        while (head) {\r\n            if (head.val === val) {\r\n                prev.next = head.next;\r\n                this.length--;\r\n                break;\r\n            }\r\n            prev = head;\r\n            head = head.next;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * insert a node after specified position.\r\n     */\r\n    insert(val, index = this.length - 1) {\r\n        if (index > this.length) {\r\n            console.log(`index ${index} is bigger than this list's length ${this.length}.`);\r\n        }\r\n        let count = index + 1;\r\n        let head = this.node;\r\n        while (count !== 0) {\r\n            head = head.next;\r\n            count--;\r\n        }\r\n        head.next = new ListNode(val, head.next);\r\n        this.length++;\r\n    }\r\n\r\n    /**\r\n     * Print all the values in this LinkedList\r\n     */\r\n    print() {\r\n        let head = this.node.next;\r\n        while (head) {\r\n            console.log(head.val);\r\n            head = head.next;\r\n        }\r\n    }\r\n}\r\nclass ListNode {\r\n    constructor(val, next) {\r\n        this.val = val ? val : null;\r\n        this.next = next ? next : null;\r\n    }\r\n}\r\n\r\nlet a = new LinkedList;\r\na.append(1);\r\na.append(2);\r\na.append(3);\r\na.print(); // 1,2,3\r\na.delete(3);\r\na.insert(4, 0);\r\na.insert(5);\r\na.print(); //1, 4, 2, 5\r\nconsole.log(a.length); //4\r\n```\r\n\r\n",
      "data": {
        "title": "Javascript instance LinkedList with simple code",
        "date": "2022-10-11 14:13:55",
        "tags": [
          "program"
        ],
        "published": true,
        "hideInList": false,
        "feature": null,
        "isTop": false
      },
      "isEmpty": false,
      "excerpt": "",
      "abstract": "",
      "fileName": "javascript-instance-linkedlist-with-simple-code"
    },
    {
      "content": "用telegram的bot寫了點小工具，\r\n用Webhook的話記得php那邊要這樣接資料\r\n```php=\r\n// Takes raw data from the request\r\n$json = file_get_contents('php://input');\r\n// Converts it into a PHP object\r\n$lastMsg = json_decode($json, true);\r\n```\r\n測試的時候用getUpdates\r\ngetUpdate version\r\n```php=\r\n $url = \"https://api.telegram.org/bot.../getUpdates\";\r\n $s = json_decode(file_get_contents($url), true);\r\n $msgList = [];\r\n foreach ($s['result'] as $v) {\r\n     $msgList[] = $v;\r\n }\r\n $lastMsg = $msgList[count($msgList) - 1];\r\n ```\r\n #用webhook就不能用getUpdates\r\n\r\n 看Webhook有沒有異常，pending_updates不是0的話表示有異常訊息\r\nhttps://api.telegram.org/bot.../getWebhookInfo\r\n\r\n清空pending_updates\r\nhttps://api.telegram.org/bot.../setWebhook?url=webhook_url&drop_pending_updates=true\r\n\r\n啟動webhook\r\nhttps://api.telegram.org/bot.../setWebhook?url=webhook_url\r\n\r\n關閉 webhook\r\nhttps://api.telegram.org/bot.../setWebhook?url=\r\n\r\n希望bot是自己私人用的，就在webhook的php那邊加上判斷來源id的部分\r\n```php=\r\n$allowID = [\r\n    \"ID_1\",\r\n    \"ID_2\"\r\n];\r\nif(!in_array($lastMsg['message']['from']['id'],$allowID)) return false;\r\n```\r\n\r\n因為webhook不太好看有沒有記錄傳進來，所以我用了個資料表專門記錄傳進來的資料\r\n\r\n因為telegram的伺服器會有時差，連db的設定檔可以多這句\r\n```php=\r\n$GLOBALS['pdo']->prepare(\"SET time_zone = 'Asia/Taipei'\");\r\n```\r\n程式內若有用到DateTime()，也可以靠這句改時區\r\n```php=\r\n$dt = new DateTime('now', new DateTimeZone('Asia/Taipei'));\r\n```",
      "data": {
        "title": "Telegram Bot 開發心得",
        "date": "2022-07-25 17:03:49",
        "tags": [
          "program"
        ],
        "published": true,
        "hideInList": false,
        "feature": null,
        "isTop": false
      },
      "isEmpty": false,
      "excerpt": "",
      "abstract": "",
      "fileName": "telegram-bot-kai-fa-xin-de"
    },
    {
      "content": "複製到剪貼簿\r\n```javascript=\r\n    <div onclick=\"copy(this)\">text for copying.</div>\r\n    function copy(element) {\r\n        console.log($(element));\r\n        let str = $(element).text();\r\n        navigator.clipboard.writeText(str).then(() =>\r\n            alert(\"copied\");\r\n        );\r\n    };\r\n```\r\n比直接用append更好的產生element的方式\r\n```javascript=\r\nlet option = $(\"<option>\", {\"d-id\":e['id'], text: e['name']});\r\n$(\"#type\").append(option);\r\n```\r\najax範例\r\n```js=\r\n $.ajax({\r\n            url: url,\r\n            data,\r\n            method: \"GET\",\r\n            dataType: \"json\",\r\n        }.done((rs) => {\r\n\r\n        }).fail((rs) => {\r\n\r\n        })\r\n```\r\najax會重複用的話可以變成一個新的function\r\n```js=\r\n    let callAjax = (data, url, method, dataType) => {\r\n        return $.ajax({\r\n            url,\r\n            data,\r\n            method,\r\n            dataType,\r\n        });\r\n    }\r\n    callAjax(data, url, method, dataType).done()...\r\n```\r\n\r\nArray common function\r\n\r\n```javascript=\r\n//add vs delete\r\npush()  pop() //latest element in this array\r\nunshift()  shift() //first element in this array\r\n\r\nsplice(index, nums) //remove the specified position element with multiple amount.\r\n\r\nreverse() //reverse this array.\r\n\r\narr1.concat(arr2) // return a new array with two arrays combination, it won't change neither arr1 nor arr2.\r\n\r\nincludes(val) //return true if array contains this value, else return false\r\n\r\nindexOf(val) //like include, but return the position, or -1\r\n\r\njoin(', ') //print out the element as string, split with argument\r\n```\r\n\r\n",
      "data": {
        "title": "常用的程式碼 - Javascript",
        "date": "2022-07-25 14:31:42",
        "tags": [
          "常用的程式碼"
        ],
        "published": true,
        "hideInList": false,
        "feature": null,
        "isTop": false
      },
      "isEmpty": false,
      "excerpt": "",
      "abstract": "",
      "fileName": "chang-yong-de-cheng-shi-ma-javascript"
    },
    {
      "content": "創建新欄位\r\n在TABLE內新增欄位\r\nALTER TABLE 資料表名稱 ADD COLUMN 欄位名稱 形態(長度);\r\nALTER TABLE member ADD COLUMN tg_id int(64) NOT NULL AFTER FB_id, ADD INDEX(tg_id);\r\n在TABLE內新增欄位，欄位必須加入INDEX並且設定DEFAULT值\r\nALTER TABLE 資料表名稱 ADD COLUMN 欄位名稱 形態(長度), ADD INDEX(欄位名稱);\r\n\r\n\r\n刪除所有問號\r\nUPDATE `test` SET `content`= REPLACE(content, '?', '') WHERE `content` LIKE \"%?%\"\r\n\r\n正規表達式\r\nUPDATE `test` SET `msg`=REGEXP_REPLACE(msg,'(.*)( $)','\\\\1') WHERE msg REGEXP '.* $'\r\n\r\n查所有外來鍵\r\nSELECT * FROM information_schema.TABLE_CONSTRAINTS WHERE CONSTRAINT_TYPE = \"FOREIGN KEY\" AND CONSTRAINT_SCHEMA = \"test\"\r\n\r\n叢集+GROUP BY\r\nSELECT name, subject FROM `student`, score GROUP BY name, subject\r\n\r\n範例 拿缺考的學生\r\nSELECT name, subject FROM `student`, score WHERE (subject, name) NOT IN ( SELECT s.subject as subject, c.name as name FROM score s LEFT JOIN student c ON c.id = s.id) GROUP BY name, subject\r\n\r\n排名 DENSE_RANK()\r\nSELECT score, DENSE_RANK() OVER (\r\n    ORDER BY score DESC\r\n) `rank`\r\nFROM Scores ORDER BY score DESC;\r\n\r\n取第二高的薪水，沒有的話顯示null\r\nSELECT CASE WHEN COUNT(b.c) > 0 THEN b.c ELSE null END AS SecondHighestSalary\r\nFROM (SELECT DISTINCT salary as c FROM Employee ORDER BY salary DESC LIMIT 1,1) b;\r\n\r\n//看別人的，優化版\r\nSELECT (CASE \r\n        WHEN (SELECT COUNT(DISTINCT Salary) FROM Employee) < 2 \r\n        THEN NULL \r\n        ELSE (SELECT Salary FROM Employee \r\n              ORDER BY Salary DESC LIMIT 1,1) \r\n        END) AS SecondHighestSalary\r\n\r\n跳過前3筆 OFFSET\r\nSELECT DISTINCT(salary) from Employee order by salary DESC LIMIT 1 OFFSET 3",
      "data": {
        "title": "常用的程式碼 - MySQL",
        "date": "2022-07-13 11:49:01",
        "tags": [
          "常用的程式碼"
        ],
        "published": true,
        "hideInList": false,
        "feature": null,
        "isTop": false
      },
      "isEmpty": false,
      "excerpt": "",
      "abstract": "",
      "fileName": "chang-yong-de-cheng-shi-ma-mysql"
    },
    {
      "content": "git add --all :/ 加入所有有修改的檔案\r\n(在根目錄 git add . 是一樣的效果)\r\ngit add -u 檔名有改/刪除的話用這個\r\ngit config --global --list\r\ngit reset HEAD filename 取消git add的檔案\r\ngit stash 暫存目前修改的狀態，然後還原成原本的樣子(untrach的file不會被暫存)\r\ngit stash pop 還原最新一筆stash\r\ngit stash list 列出所有暫存\r\ngit commit -m \"註解\" commit直接下註解",
      "data": {
        "title": "常用的程式碼 - git",
        "date": "2022-07-13 11:42:03",
        "tags": [
          "常用的程式碼"
        ],
        "published": true,
        "hideInList": false,
        "feature": null,
        "isTop": false
      },
      "isEmpty": false,
      "excerpt": "",
      "abstract": "",
      "fileName": "chang-yong-de-cheng-shi-ma-git"
    },
    {
      "content": "ps aux|grep master //查所有socket的執行緒\r\nss -nlp|grep 5000 //5000是port 查對應的pid用\r\nkill -15 {pid} 砍pid的程式，會跟著砍子程式，程式當機會砍不掉\r\nkill -9 {pid} 強制砍pid的程式，子程式的父pid會變1\r\nphp server_global_customer.php 可以開socket\r\ncrontab -e 編輯crontab\r\n-l 看crontab\r\n-r 全部刪除\r\n\r\n查檔案\r\nfind . -name \"*.txt\"\r\n\r\nkill -USR1 {pid} 熱重啟(socket主程式修改的話要砍掉重開)\r\ntail -f swoole.log 一直偵測log的最新訊息\r\ntail -f swoole.log | grep \"關鍵字\" 偵測關鍵字\r\ncat swoole.log | grep \"關鍵字\" 印出所有有關鍵字的\r\necho > swoole.log 清空log\r\ncat swoole.log | grep \"關鍵字\" -C 5 印出關鍵字與上下五行\r\ncat swoole.log | grep \"關鍵字\" > text.log 把log寫進text.log\r\n\r\ngit config --global  --list\r\n\r\ngrep -Frnw '.' -e '登入頁面' 目錄中找關鍵字\r\n-F 用簡單的字串查詢\r\n-r recursive\r\n-n 列出Line\r\n-w 字串全部對上才會顯示\r\n\r\nnetstat -tulpn | grep LISTEN 查PORT+PID",
      "data": {
        "title": "常用的程式碼 - 指令",
        "date": "2022-07-13 11:38:45",
        "tags": [
          "常用的程式碼"
        ],
        "published": true,
        "hideInList": false,
        "feature": null,
        "isTop": false
      },
      "isEmpty": false,
      "excerpt": "",
      "abstract": "",
      "fileName": "chang-yong-de-cheng-shi-ma-zhi-ling"
    },
    {
      "content": "\r\n```php=\r\n    //SELECT\r\n    Yii::app()->db->createCommand(\"SELECT * FROM test WHERE id = 1\")->queryAll();\r\n    //UPDATE, DELETE, INSERT\r\n    Yii::app()->db->createCommand(\"...\")->execute();\r\n\r\n    //Model Search\r\n    //By Attributes\r\n    $member = Member::model()->findByAttributes(['role' => 1]);\r\n    //Primary key, ex: id = 1\r\n    $member = Member::model()->findByPk(1);\r\n\r\n    //transaction start\r\n    $transaction = Yii::app()->db->beginTransaction();\r\n    //commit\r\n    $transaction->commit();\r\n    //rollback\r\n    $transaction->rollback();\r\n\r\n    //request\r\n    $request = app()->request;\r\n    //GET, default = 1\r\n    $id = $request->getQuery('id', '1');\r\n    //POST\r\n    //is this from post\r\n    if($request->isPostRequest){...}\r\n    //getPost, default = 1\r\n    $id = $request->getPost('id', '1');\r\n\r\n    //dataProvider by array data\r\n    $dataProvider = new CArrayDataProvider($data, [\r\n    'sort' => array(\r\n        'defaultOrder' => 'id ASC',\r\n        'attributes' => array(\r\n            \"id\", \"count\" //可以點擊排序\r\n        )\r\n    ),\r\n]);\r\n\r\n//Criteria\r\n$criteria = new CDbCriteria;\r\n$criteria->addBetweenCondition('t.created_at', $dateStart, $dateEnd);\r\n$dataProvider = new CActiveDataProvider('tablename', [\r\n    'criteria' => $criteria,\r\n    'sort' => array(\r\n        'attributes' => array(\r\n            '*'\r\n        ),\r\n    ),\r\n]);\r\n\r\n```\r\n\r\nModel 配 GridView 要用到FK的時候\r\n在model內命名一個public $var;\r\nmodel的rules的on => search前面加上要查詢的FK\r\n```php=\r\narray('id, content, type', 'safe', 'on' => 'search')\r\n```\r\n1. 在model內有用relations\r\n```php=\r\n$criteria->with = ['orig'];\r\n$criteria->compare('orig.type', $this->type, true);\r\n```\r\n2. 在model內沒有用relations，或其他需要join的時候\r\n```php=\r\n$criteria->join = 'LEFT JOIN member b ON b.id = t.upper';\r\n$criteria->compare('b.username', $this->upper_username, true);\r\n```\r\n在return的地方兩者都需要在attributes內加上排序用\r\n```php=\t\r\nreturn new CActiveDataProvider('ModelName', array(\r\n        'criteria' => $criteria,\r\n        'sort' => array(\r\n            'attributes' => array(\r\n                'type' => array(\r\n                    'asc' => 'orig.type',\r\n                    'desc' => 'orig.type DESC',\r\n                ),\r\n                '*',\r\n            ),\r\n        ),\r\n    ));\r\n```\r\nview的地方\r\n為了可以查詢，要加上name\r\n如果是用relations的話，沒有特別要寫html就不需要value了\r\n```php=\r\n[\r\n    'name' => 'type',\r\n    'type' => 'raw', //value return 的才會變html\r\n    'header' => '類型',\r\n    'headerHtmlOptions' => array(\"class\" => 'span3'),\r\n    'value' => function ($data)\r\n    {\r\n        return \"<h3>\".$data->orig->type.\"</h3>\"\r\n    }\r\n],\r\n```\r\n\r\nview的CGridView直接用relations\r\n```php=\r\n[\r\n    'header' => 'id',\r\n    'value' => '$data->relations->id,\r\n],\r\n```\r\n\r\n用toggle快速改狀態\r\n```php=\r\n\r\n<?php\r\nYii::app()->clientScript->registerCssFile('/include/bootstrap-toggle/css/bootstrap2-toggle.min.css');\r\nYii::app()->clientScript->registerScriptFile('/include/bootstrap-toggle/js/bootstrap2-toggle.min.js');\r\n\r\n//GridView\r\n[\r\n    'header' => '已發送',\r\n    'type' => 'raw',\r\n    'value' => function ($data)\r\n    {\r\n        $check = ($data->paid == 0) ? '' : 'checked';\r\n        return \"<input {$check} class='active-btn' onchange='toggleActive({$data->id})' data-toggle='toggle' data-on='Y' data-off='N' data-onstyle='success' data-offstyle='danger' type='checkbox'>\";\r\n    },\r\n],\r\n?>\r\n<script type=\"text/javascript\">\r\n\t// 修改狀態\r\n\tfunction toggleActive(id) {\r\n\t\t$.ajax({\r\n\t\t    url: \"<?= $this->createUrl('ToggleActive'); ?>\",\r\n\t\t    type: \"POST\",\r\n\t\t    dataType: \"JSON\",\r\n\t\t    data: {\r\n\t\t    \tid:id\r\n\t\t    },\r\n\t\t    success: function (response) {\r\n\t\t        alert((response.status == 1) ? '修改成功' : response.msg);\r\n\t\t    },\r\n\t\t    error: function (XMLHttpRequest, textStatus, errorThrown) {\r\n\t\t        alert(XMLHttpRequest.readyState + XMLHttpRequest.status + XMLHttpRequest.responseText);\r\n\t\t    },\r\n\t\t});\r\n\t}\r\n</script>\r\n\r\n//controller的部分\r\n<?php\r\n    public function actionToggleActive()\r\n    {\r\n        $request = app()->request;\r\n        if ($request->isPostRequest) {\r\n            try {\r\n                $id = $request->getPost('id');\r\n                if (!isset($id))\r\n                    throw new Exception('Error', 1);\r\n\r\n                $model = Member::model()->findByPk($id);\r\n                if (!$model)\r\n                    throw new Exception('查無資料', 1);\r\n\r\n                $model->status = ($model->status == 0) ? 1 : 0;\r\n                $model->saveAttributes(['status']);\r\n\r\n                echo json_encode([\r\n                    'status' => 1,\r\n                ]);\r\n            } catch (Exception $e) {\r\n                echo json_encode([\r\n                    'status' => 0,\r\n                    'msg' => $e->getMessage(),\r\n                ]);\r\n            }\r\n        }\r\n    }\r\n    ?>\r\n```\r\n\r\naccessRule\r\n```php=\r\n<?php\r\n    public function accessRules()\r\n    {\r\n        return array(\r\n            [\r\n                //所有會員\r\n                'allow',\r\n                'actions' => ['a'],\r\n                'users' => ['*'],\r\n            ],\r\n            [\r\n                //登入的會員無法到登入、註冊\r\n                'deny',\r\n                'actions' => ['login', 'register'],\r\n                'users' => ['@'],\r\n                'deniedCallback' => function () {\r\n                    Yii::app()->controller->redirect(['/site/index']);\r\n                },\r\n            ],\r\n            [\r\n                //expression，誰適用於這個規則，配deniedCallback\r\n                'deny',\r\n                'users' => ['@'],\r\n                'expression' => [$this, 'isStatusNotAllowed'],\r\n                'deniedCallback' => function () {\r\n                    Yii::app()->controller->redirect(['/site/index']);\r\n                },\r\n            ],\r\n            [\r\n                //expression，也可用在allow\r\n                'allow',\r\n                'actions' => ['b'],\r\n                'users' => ['@'],\r\n                'expression' => [$this, 'isStatusAllow'],\r\n            ],\r\n            [\r\n                'allow',\r\n                'users' => ['@'],\r\n            ],\r\n            [\r\n                //未登入的會員\r\n                'allow',\r\n                'actions' => ['login', 'register'],\r\n                'users' => ['?'],\r\n            ],\r\n            [\r\n                //deny所有，做安全保障\r\n                'deny',\r\n                'users' => ['*'],\r\n                'deniedCallback' => function () {\r\n                    Yii::app()->controller->redirect(['/site/login']);\r\n                },\r\n            ],\r\n        );\r\n    }\r\n\r\n    protected function isStatusNotAllowed()\r\n    {\r\n        if (app()->user->isGuest) return false;\r\n        $notAllowed = [...];\r\n        $member = Member::model()->findByAttributes(['id' => app()->user->id]);\r\n        return in_array($member->status, $notAllowed);\r\n    }\r\n\r\n    protected function isStatusAllow()\r\n    {\r\n        $member = Member::model()->findByAttributes(['id' => app()->user->id]);\r\n        return !$member->status == Member::STATUS_ALLOW;\r\n    }\r\n?>\r\n```",
      "data": {
        "title": "常用的程式碼 - Yii",
        "date": "2022-07-13 11:37:14",
        "tags": [
          "常用的程式碼"
        ],
        "published": true,
        "hideInList": false,
        "feature": null,
        "isTop": false
      },
      "isEmpty": false,
      "excerpt": "",
      "abstract": "",
      "fileName": "chang-yong-de-cheng-shi-ma-yii"
    },
    {
      "content": "\r\n<span class=\"subtitle\">隨筆</span>\r\n有遇過kill -15 PID 結果砍不掉的問題\r\n但是程式整個卡住，無法確定是不是因為程式跑太久，或是有太多連線導致程式無法正常結束\r\n此時就會用kill -9強制結束\r\n但kill -9 無法砍掉子行程，會讓子行程的父PID變成1\r\n如果kill -15不行，就-9把master砍掉，再把底下的子行程用-15砍掉，看能不能全砍\r\n\r\nps -ef | grep webServer 看這隻程式與子行程\r\n所有人 PID 父PID(最大是1) unknown 執行時間 unknown 執行多久 後面參數不確定\r\nps aux | grep master 看所有master",
      "data": {
        "title": "kill -9 v.s. kill -15",
        "date": "2022-07-11 16:43:13",
        "tags": [
          "program"
        ],
        "published": true,
        "hideInList": false,
        "feature": null,
        "isTop": false
      },
      "isEmpty": false,
      "excerpt": "",
      "abstract": "",
      "fileName": "kill-9-vs-kill-15"
    },
    {
      "content": "\r\n<h1>PHP</h1>\r\n\r\nDateTime\r\n```php=\r\n//拿現在時間\r\n$dt = new \\DateTime('NOW');\r\n//拿月初 2022-07-01 00:00:00\r\n$dateStart = $dt->format('Y-m-01 00:00:00');\r\n//拿月底 2022-07-31 23:59:59\r\n$dateEnd = $dt->format('Y-m-t 23:59:59');\r\n//拿上個月月初\r\n$dateStart = date('Y-m-01 00:00:00', strtotime('-1 month'));\r\n//拿上個月月底\r\n$dateEnd = date('Y-m-t 23:59:59', strtotime($dateStart));\r\n\r\n//日期轉成星期幾\r\n$day = DayOfWeekToChineseDay(date('w', strtotime($dateStart)));\r\n$dateStartShow = date(\"Y-m-d({$day}) H:i:s\", strtotime($dateStart));\r\n    \r\nfunction DayOfWeekToChineseDay($day)\r\n{\r\n    switch ($day) {\r\n        case \"0\":\r\n            return \"日\";\r\n        case \"1\":\r\n            return \"一\";\r\n        case \"2\":\r\n            return \"二\";\r\n        case \"3\":\r\n            return \"三\";\r\n        case \"4\":\r\n            return \"四\";\r\n        case \"5\":\r\n            return \"五\";\r\n        case \"6\":\r\n            return \"六\";\r\n    }\r\n}\r\n```\r\n\r\n密碼驗證\r\n```php=\r\n// 線上生成的都用這個，很好用\r\n// https://phppasswordhash.com/\r\n// 產生PWD\r\npassword_hash($pwd, PASSWORD_DEFAULT)\r\n// 驗證用\r\npassword_verify($pwd, $hash)，正確回傳true\r\nif (!password_verify($pwd, $hash))\r\n    throw new Exception(\"錯誤\");\r\n```\r\n\r\nArray\r\n```php=\r\n//array_chunk($arr, $len, bool $preserve_keys) 切割陣列內元素成子陣列，preserve_keys = true會保留KEY\r\n$d = [1,2,3,4];\r\nprint_r(array_chunk($d, 2));\r\noutput: [[1,2], [3,4]]\r\n\r\n//implode(\" \", $arr) Array to String connects with needles\r\n$d = [1,2,3,4];\r\nprint_r(implode(\" \", $d));\r\noutput: 1 2 3 4\r\n\r\n//explode(\" \", $str) String to Array split with needles\r\n$s = \"1 2 3 4\";\r\nprint_r(explode(\" \",$s));\r\noutput: [1,2,3,4]\r\n```",
      "data": {
        "title": "常用的程式碼 - PHP",
        "date": "2022-07-07 14:09:00",
        "tags": [
          "常用的程式碼"
        ],
        "published": true,
        "hideInList": false,
        "feature": null,
        "isTop": false
      },
      "isEmpty": false,
      "excerpt": "",
      "abstract": "",
      "fileName": "chang-yong-de-cheng-shi-ma-ji-lu"
    },
    {
      "content": "\r\n<span class=\"subtitle\">拿來測CSS方便我寫作 珍香</span>\r\n```php=\r\n$j = 1;\r\n$j += 2;\r\nconsole.log(\"hji\");\r\n```",
      "data": {
        "title": "測試CSS",
        "date": "2022-06-23 15:35:12",
        "tags": [],
        "published": false,
        "hideInList": true,
        "feature": null,
        "isTop": false
      },
      "isEmpty": false,
      "excerpt": "",
      "abstract": "",
      "fileName": "ce-shi-css"
    },
    {
      "content": "<span class=\"subtitle\">前言</span> <span class=\"content\">個人隨筆，簡單紀錄一下會用到的時機</span>\r\n\r\n---\r\nSQL = RDBMS，關聯式資料庫\r\nNoSQL 就是相反的非關聯式資料庫\r\n\r\nSQL可以保證資料的完整性，永久性，還可以保證獨一性，對於需要用到有互相關連的資料會比較適合，像是作者跟文章，然後這作者又有自己的設定檔、簡介等等情況，用SQL會比較方便。\r\nSQL的Schema需要先設計好，不然之後要更改的時候如果有資料了會很麻煩，因為資料型態要一樣。\r\n不好用於分散式資料庫，因為不同資料彼此之間可能會有關聯，如果分散在不同資料庫，查詢起來會很麻煩，通常要升級效能的話直接升級伺服器會比較好（vertical scaling）。\r\n\r\nNoSQL的話就像一堆文件存在伺服器內，每個文件的資料格式不用一樣，目前還沒有遇到會想使用NoSQL的情況，用於分散式資料庫會比較方便（horizontal scaling），畢竟都是存文件，也不會需要注意一致性跟完整性的問題，所以與其升級一台主機的效能，不如多開幾台幫忙存就好了。",
      "data": {
        "title": "SQL vs NoSQL",
        "date": "2022-06-23 15:03:57",
        "tags": [
          "program"
        ],
        "published": true,
        "hideInList": false,
        "feature": null,
        "isTop": false
      },
      "isEmpty": false,
      "excerpt": "",
      "abstract": "",
      "fileName": "sql-vs-nosql"
    }
  ],
  "tags": [
    {
      "index": -1,
      "name": "常用的程式碼",
      "slug": "nXMUqZgXX",
      "used": true
    },
    {
      "index": -1,
      "name": "program",
      "slug": "hBJuzNhU4",
      "used": true
    }
  ],
  "menus": [
    {
      "link": "/",
      "name": "Index",
      "openType": "Internal"
    },
    {
      "link": "/archives",
      "name": "Archives",
      "openType": "Internal"
    },
    {
      "link": "/tags",
      "name": "Tags",
      "openType": "Internal"
    }
  ]
}